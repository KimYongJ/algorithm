# [Platinum IV] 겨울나기 - 18135 

[문제 링크](https://www.acmicpc.net/problem/18135) 

### 성능 요약

메모리: 124956 KB, 시간: 1124 ms

### 분류

자료 구조, 느리게 갱신되는 세그먼트 트리, 세그먼트 트리

### 제출 일자

2025년 3월 16일 22:05:20

### 문제 설명

<p>가톨릭대학교 텔레토비 동산에는 겨울을 준비하는 다람쥐 다다가 살고 있다. 다다는 교내에서 자신만의 원형의 산책로를 가지고 있다.</p>

<p style="text-align: center;"><img alt="" src="https://upload.acmicpc.net/945f62f4-b2eb-4690-bf87-811a2e97ee77/" style="width: 600px; height: 480px;"></p>

<p>다다는 원형의 산책로를<em> N</em> (1 ≤ <em>N</em> ≤ 2,000,000)개의 칸으로 구분하고 1번부터 <em>N</em>번 까지 번호를 매겼고, 한 개의 칸 혹은 연속된 여러 칸을<em> M</em> (1 ≤ <em>M</em> ≤ 1,000,000)개의 영역으로 지정했으며, 1번부터 <em>M</em>번까지 번호를 매겼다. 한 영역은 꽃밭, 건물 등 학교에서의 한 장소나 시설을 의미한다. 1번 칸은 무조건 1번 영역에 속하고 어떤 영역에도 속하지 않는 칸은 없다. 칸과 영역의 번호는 시계방향으로 순서대로 매겨지며, 다다의 이동 방향도 시계방향으로만 움직인다.</p>

<p>영역은 겹치지 않으며, 각 영역마다 도토리를 저장해 두었다.</p>

<p>겨울이 오기 전 산책로를 따라 걸으며 어떤 영역에 포함되는 칸을 지나면 그 영역에 저장된 도토리의 수량을 합하며 점검하고, 산책 중에 학생들에게 받은 도토리들을 저장하려고 한다. 겨울잠이 끝나고 다람쥐 다다가 눈을 뜰 수 있도록 다다를 도와주자.</p>

### 입력 

 <p>첫 줄에 두 정수 산책로의 칸수 <em>N</em>, 영역 수 <em>M</em>이 주어진다.</p>

<p>두 번째 줄부터 <em>M</em>개의 줄에 세 개의 정수 <em>a</em> (1 ≤ <em>a</em> ≤ N), <em>b</em> (1 ≤ <em>b</em> ≤ N), <em>c</em> (0 ≤ <em>c</em> ≤ 100,000)가 주어지고 영역의 시작 칸의 번호, 끝 칸의 번호, 그 영역에 저장되어있는 도토리의 개수를 뜻한다. 1번 영역부터 순서대로 입력이 주어진다.</p>

<p>이어서 <em>M</em>+2번째 줄부터 다다의 작업들이 주어지는데, 3개의 정수 혹은 4개의 정수가 주어진다.</p>

<p>첫 번째 정수가 1인 경우는 이어서 <em>x</em> (1 ≤ <em>x</em> ≤ N), <em>y</em> (1 ≤ <em>y</em> ≤ N)가 2인 경우에는 이어서 <em>x, y, z</em> (1 ≤ <em>z</em> ≤ 1,000,000)가 입력으로 주어진다. <em>x</em>는 산책을 시작하는 칸 번호, <em>y</em>는 산책을 종료하는 칸 번호, <em>z</em>는 추가로 저장할 도토리의 개수를 의미한다.</p>

<p>0 0 0을 입력받은 경우는 작업입력을 종료한다.</p>

<p>첫 번째 정수가 1인 경우 다다가 <em>x</em>번째 칸부터 <em>y</em>번째 칸까지 산책하며 지나가는 영역에 저장된 도토리 개수를 점검하는 작업이고, 첫 번째 정수가 2인 경우 다다가 학생들에게 받은 도토리를 <em>x</em>번째 칸부터 <em>y</em>번째 칸에 해당하는 영역들에 <em>z</em>개씩 저장하는 작업을 의미한다.</p>

<p>주어지는 <em>x</em>는 <em>y</em>보다 큰 경우도 존재한다. 다다는 시계방향으로만 산책을 하기 때문에 <em>x</em>가 <em>y</em>보다 큰 경우 <em>x</em> ➝ <em>x</em>+1 ➝ … ➝ <em>N</em> ➝ 1 ➝ 2 ➝ … ➝<em> y</em> 의 순서로 칸을 이동하는 점을 유의하라</p>

<p>작업의 개수는 200,000 개를 넘지 않으며, 한 번의 작업에서 한 영역을 두 번 방문하는 경우는 없다.</p>

### 출력 

 <p>다다의 작업입력 중 첫 번째 정수가 1인 경우 이어 입력받은 <em>x</em>부터 <em>y</em>칸에 해당하는 영역에 저장된 도토리 개수의 합을 출력한다. 모든 값의 범위는 2<sup>63</sup>보다 작다.</p>

