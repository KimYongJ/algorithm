# [Gold II] 견우와 직녀 - 16137 

[문제 링크](https://www.acmicpc.net/problem/16137) 

### 성능 요약

메모리: 15268 KB, 시간: 140 ms

### 분류

너비 우선 탐색, 그래프 이론, 그래프 탐색, 구현

### 제출 일자

2024년 2월 28일 23:39:23

### 문제 설명

<p>견우와 직녀는 여러 섬과 절벽으로 이루어진 지역에서 살고 있다. 이 지역은 격자로 나타낼 수 있으며, 상하좌우로 인접한 칸으로 가는 데 1분이 걸린다.</p>

<p>7월 7일은 견우와 직녀가 오작교를 건너 만날 수 있는 날이다. 그런데 고령화로 인해서 까마귀와 까치가 예전처럼 커다란 오작교를 만들 수 없다. 그래서 요즘은 일부 절벽에만 다리를 만들어 주고 있고, 그마저도 힘들어서 몇 분 주기로 오작교를 짓고 해체하는 작업을 반복해야 한다. 한 번 지은 오작교는 1분 동안 유지할 수 있다.</p>

<p>예를 들어 오작교가 3분과 4분 주기라면, 건널 수 있는 시간은 아래 그림에서 초록색으로 표시한 부분과 같다.</p>

<table class="table table-bordered" style="width: 100%;">
	<tbody>
		<tr>
			<td style="text-align: center;"><img alt="" src="https://upload.acmicpc.net/ec16292c-82ee-4005-9396-68b7a6553bf0/-/preview/" style="width: 400px; height: 58px;"></td>
			<td style="text-align: center;"><img alt="" src="https://upload.acmicpc.net/0b4fc5d2-e569-42eb-8aed-7217c1cbe58a/-/preview/" style="width: 400px; height: 58px;"></td>
		</tr>
		<tr>
			<td style="text-align: center;">T = 3</td>
			<td style="text-align: center;">T = 4</td>
		</tr>
	</tbody>
</table>

<p>오작교는 이처럼 매우 불안정하므로, 견우는 안전을 위해 두 번 연속으로 오작교를 건너지는 않기로 했다.</p>

<p>까마귀와 까치는 조금이라도 견우를 더 도와주기 위해, 절벽을 정확히 하나 골라 주기가 M분인 오작교를 하나 더 놓아 주기로 했다. 단, 이미 오작교를 짓기로 예정한 절벽에는 오작교를 하나 더 놓을 수 없고, 아래와 같이 절벽이 가로와 세로로 교차하는 곳에도 오작교를 놓을 수 없다.</p>

<p>아래 그림에서 파란색은 견우가 건널 수 있는 일반적인 땅, 검은색은 절벽, 흰색은 절벽이 교차해서 오작교를 놓을 수 없는 위치를 나타낸다.</p>

<p style="text-align: center;"><img alt="" src="https://upload.acmicpc.net/478968f8-19f0-4605-9644-94b1cd89c378/-/preview/" style="width: 250px; height: 250px;"><img alt="" src="https://upload.acmicpc.net/e3614d8e-4d04-44ea-9dbb-07e4a2f23328/-/preview/" style="width: 250px; height: 250px;"><img alt="" src="https://upload.acmicpc.net/362105a1-75ca-4286-8f63-684daf820c92/-/preview/" style="width: 250px; height: 250px;"></p>

<p>견우가 직녀에게 도착할 수 있는 최소의 시간을 찾아 보자.</p>

### 입력 

 <p>첫째 줄에 지형의 행과 열의 크기를 나타내는 정수 N (2 ≤ N ≤ 10)과 새로 만들어지는 오작교의 주기를 의미하는 정수 M(2 ≤ M ≤ 20)이 주어진다.</p>

<p>다음 N개의 줄에는 줄마다 배열의 각 행을 나타내는 N개의 정수가 한 개의 빈칸을 사이에 두고 주어진다. 각 칸에 들어가는 값은 0 이상 20 이하이다.</p>

<p>또한, 각 칸에 들어가는 정수의 의미는 다음과 같다.</p>

<ul>
	<li>1: 이동할 수 있는 일반적인 땅</li>
	<li>0: 건널 수 없는 절벽</li>
	<li>2 이상의 수: 적혀있는 수 만큼의 주기를 가지는 오작교</li>
</ul>

<p>견우의 시작점은 지형의 맨 왼쪽 위 (0, 0) 이고, 직녀가 사는 곳은 지형의 맨 오른쪽 아래인 (N-1, N-1)이다. 견우가 시작점에서 출발하는 시간은 0분이다. 견우와 직녀가 사는 곳은 일반적인 땅이다.</p>

<p>견우와 직녀가 무조건 만날 수 있는 경우만 주어진다. 또한, 주어지는 지형 정보에서 오작교를 반드시 하나 이상 놓을 수 있다. 절벽이 가로와 세로로 교차하는 지점에는 오작교가 설치되어 있지 않다.</p>

### 출력 

 <p>견우가 직녀에게 갈 수 있는 최소의 시간을 출력한다.</p>

