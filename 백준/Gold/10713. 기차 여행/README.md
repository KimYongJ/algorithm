# [Gold IV] 기차 여행 - 10713 

[문제 링크](https://www.acmicpc.net/problem/10713) 

### 성능 요약

메모리: 63276 KB, 시간: 604 ms

### 분류

누적 합

### 제출 일자

2025년 1월 7일 17:21:23

### 문제 설명

<p>JOI나라에는 N개의 도시가 있고, 각 도시에 1,2,...,N까지의 번호를 갖고 있다.</p>

<p>그리고, 철도가 N-1개 있고, 각 철도에 1,2,...N-1의 번호를 갖고 있다.</p>

<p>철도 i (1 ≦ i ≦ N − 1)는 도시 i과 도시 i+1을 양방향으로 연결시키는 철도를 의미한다.</p>

<p>JOI나라의 철도를 타는 방법에는, 티켓을 구입해 승차하는 방법과 IC카드로 승차하는 방법 두 가지가 존재한다.</p>

<ul>
	<li>철도 i에 티켓을 구입해 승차할 때는 A<sub>i</sub> 원의 비용이 든다.</li>
	<li>철도 i에 IC카드로 승차하는 경우에는 B<sub>i</sub> 원의 비용이 든다. 하지만 IC카드로 철도를 탈 때는 IC카드를 미리 구입해둬야만 한다. 철도 i에서 쓸 수 있는 IC카드를 구입하는데는 Ci원의 비용이 든다. 한번 구입한 IC카드는 몇번이라도 사용할 수 있다.</li>
</ul>

<p>IC카드가 처리가 간편하기 때문에, IC카드로 승차하는 방법의 운임이 티켓을 구입하는 경우보다 싸다. 즉, i = 1,2,...N-1일 때 A<sub>i</sub> > B<sub>i</sub>이다. IC카드는 철도마다 다르기 때문에, 철도 i에서 사용할 수 있는 카드는 다른 철도에서는 사용할 수 없다.</p>

<p>당신은 JOI나라를 여행하기로 마음먹었다. 도시 P<sub>1</sub>에서 출발해, P<sub>2</sub>,P<sub>3</sub>... ,P<sub>M</sub> 순서의 도시를 방문할 예정이다. 여행은 M-1일간 이루어진다. j일째 (1 ≦ j ≦ M − 1) 에 도시 P<sub>j</sub>으로부터 P<sub>j+1</sub>으로 이동한다. 이때, 여러 개의 철도를 타는 경우도 있고, 같은 도시를 여러 번 방문할 수도 있다. JOI나라의 철도는 빨라서 어느 도시도 하루만에 도착할 수 있다</p>

<p>당신은 현재 어느 철도의 IC카드도 갖고있지 않다. 당신은 미리 몇개의 IC카드를 구입해, 이 여행에서 사용되는 비용, 즉 IC카드를 구입하는 비용 + 철도를 타는 비용을 최소화하고 싶다.</p>

<p>JOI나라의 도시 수, 여행의 기간, 그리고 JOI나라의 철도 각각의 운임과, IC카드의 가격이 주어졌을 때, 여행의 비용을 최소화하는 프로그램을 작성하시오.</p>

### 입력 

 <p>첫 번째 줄에서는 정수 N, M이 주어진다.</p>

<p>두 번째 줄에는 M개의 정수 P<sub>1</sub>,P<sub>2</sub>,...P<sub>M</sub>이 주어진다. j일째 (1 ≦ j ≦ M − 1) 에 도시 P<sub>j</sub>에서 P<sub>j+1</sub>로 이동하는 것을 의미한다.</p>

<p>3번째 줄부터 N-1개의 줄에는 (1 ≦ i ≦ N − 1) 3개의 정수 A<sub>i</sub>, B<sub>i</sub>, C<sub>i</sub>가 주어진다. 각각 철도 i의 티켓을 구입하는 가격, 철도 i를 카드를 사용했을 때 통과하는 가격, IC카드를 구매하는 가격을 의미한다.</p>

### 출력 

 <p>여행에 드는 최저 비용을 첫째 줄에 출력하시오.</p>

