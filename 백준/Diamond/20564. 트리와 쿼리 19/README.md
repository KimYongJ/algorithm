# [Diamond IV] 트리와 쿼리 19 - 20564 

[문제 링크](https://www.acmicpc.net/problem/20564) 

### 성능 요약

메모리: 310912 KB, 시간: 4356 ms

### 분류

자료 구조, Heavy-light 분할, 느리게 갱신되는 세그먼트 트리, 세그먼트 트리, 트리

### 제출 일자

2025년 6월 11일 13:46:14

### 문제 설명

<p>N개의 정점으로 이루어진 트리(무방향 사이클이 없는 연결 그래프)가 있다. 정점은 1번부터 N번까지 번호가 매겨져 있고, 모든 정점의 색은 검정색 또는 흰색이다.</p>

<p>아래의 쿼리를 처리하는 프로그램을 작성하시오.</p>

<ul>
	<li>X : X번 정점의 색을 바꾼다. (흰색 -> 검정색, 검정색 -> 흰색) 이후 서로 다른 모든 흰색 정점 쌍 (a,b)에 대해 LCA(최소 공통 조상)레벨의 합을 출력한다.</li>
</ul>

<p>루트 정점은 1번 정점이다. 루트 정점의 레벨은 0이며, 다른 정점의 레벨은 (부모 정점의 레벨) + 1로 정의한다.</p>

### 입력 

 <p>첫째 줄에 정점의 갯수 N과 쿼리의 갯수 Q가 주어진다.</p>

<p>뚤째 줄에는 1, 2, ⋯, N번 정점의 색을 나타내는 정수 t<sub>1</sub>, t<sub>2</sub>, ⋯, t<sub>N</sub>이 주어진다. 1 ≤ i ≤ N인 자연수 i에 대해 t<sub>i </sub>= 0인 경우 검정색이고 t<sub>i </sub>= 1인 경우 흰색이다.</p>

<p>셋째 줄에는 2, 3, ⋯, N번 정점의 부모 정점을 나타내는 자연수 P<sub>2</sub>, P<sub>3</sub>, ⋯, P<sub>N</sub>이 주어진다.</p>

<p>다음 Q개의 줄에는 쿼리를 나타내는 X가 주어진다.</p>

### 출력 

 <p>첫번째 줄에는 초기 상태의 정답을 출력한다.</p>

<p>두번째 줄부터 Q개의 줄에 걸쳐 각 쿼리의 정답을 출력한다.</p>

